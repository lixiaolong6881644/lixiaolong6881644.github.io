<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>RabbitMQ笔记(基础篇) | __°ゝ 浮华 つ __</title><meta name="keywords" content="HTML,Java,Spring,SpringBoot"><meta name="author" content="__°ゝ 浮华 つ __"><meta name="copyright" content="__°ゝ 浮华 つ __"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="RabbitMQ笔记(基础篇)MQ基本概念1. MQ概述 MQ全称 Message Queue（消息队列），是在消息传输过程中保存消息的容器。多用于分布式系统之间进行通信。    使用MQ中间件    小结：  MQ—消息队列，存储消息的中间件。 分布式系统通信两种方式：直接远程调用和&#x3D;&#x3D;借助第三方完成间接通信&#x3D;&#x3D;。 发送方称为生产者，接收方称为消费者。   2. MQ的优势和劣势2.1 优势☆应"><meta property="og:type" content="article"><meta property="og:title" content="RabbitMQ笔记(基础篇)"><meta property="og:url" content="http://lixiaogou.gitee.io/posts/0b29424708cf/index.html"><meta property="og:site_name" content="__°ゝ 浮华 つ __"><meta property="og:description" content="RabbitMQ笔记(基础篇)MQ基本概念1. MQ概述 MQ全称 Message Queue（消息队列），是在消息传输过程中保存消息的容器。多用于分布式系统之间进行通信。    使用MQ中间件    小结：  MQ—消息队列，存储消息的中间件。 分布式系统通信两种方式：直接远程调用和&#x3D;&#x3D;借助第三方完成间接通信&#x3D;&#x3D;。 发送方称为生产者，接收方称为消费者。   2. MQ的优势和劣势2.1 优势☆应"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E5%AE%9D%E9%9D%92%E5%9D%8A%E4%B8%BB%E8%85%BF.jpg"><meta property="article:published_time" content="2020-11-21T05:44:57.000Z"><meta property="article:modified_time" content="2022-12-05T07:44:36.358Z"><meta property="article:author" content="__°ゝ 浮华 つ __"><meta property="article:tag" content="HTML"><meta property="article:tag" content="Java"><meta property="article:tag" content="Spring"><meta property="article:tag" content="SpringBoot"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E5%AE%9D%E9%9D%92%E5%9D%8A%E4%B8%BB%E8%85%BF.jpg"><link rel="shortcut icon" href="http://yiguan-main.oss-cn-beijing.aliyuncs.com/tms/2020-08/1597503441421.jpg"><link rel="canonical" href="http://lixiaogou.gitee.io/posts/0b29424708cf/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><meta><meta><meta><meta><meta><meta><meta><meta><meta><meta><meta><meta><meta><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"top-right"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"RabbitMQ笔记(基础篇)",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2022-12-05 15:44:36"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/mycss.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/moyuyu.gif" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">89</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">26</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E5%AE%9D%E9%9D%92%E5%9D%8A%E4%B8%BB%E8%85%BF.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">__°ゝ 浮华 つ __</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">RabbitMQ笔记(基础篇)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-21T05:44:57.000Z" title="发表于 2020-11-21 13:44:57">2020-11-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-12-05T07:44:36.358Z" title="更新于 2022-12-05 15:44:36">2022-12-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/RabbitMQ/">RabbitMQ</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>27分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="RabbitMQ笔记(基础篇)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="RabbitMQ笔记-基础篇"><a href="#RabbitMQ笔记-基础篇" class="headerlink" title="RabbitMQ笔记(基础篇)"></a>RabbitMQ笔记(基础篇)</h1><h1 id="MQ基本概念"><a href="#MQ基本概念" class="headerlink" title="MQ基本概念"></a>MQ基本概念</h1><h2 id="1-MQ概述"><a href="#1-MQ概述" class="headerlink" title="1. MQ概述"></a>1. MQ概述</h2><blockquote><p><code>MQ全称 Message Queue（消息队列）</code>，是在消息传输过程中保存消息的容器。<code>多</code>用于<code>分布式系统之间进行通信。</code></p></blockquote><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155459.png" alt="传统服务调用20210202101233"></p><blockquote><p>使用MQ中间件</p></blockquote><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155510.png" alt="image-20201214200537641"></p><blockquote><p>小结：</p><ol><li>MQ—消息队列，存储消息的中间件。</li><li>分布式系统通信两种方式：<code>直接远程调用</code>和==借助第三方完成间接通信==。</li><li>发送方称为生产者，接收方称为消费者。</li></ol></blockquote><h2 id="2-MQ的优势和劣势"><a href="#2-MQ的优势和劣势" class="headerlink" title="2. MQ的优势和劣势"></a>2. MQ的优势和劣势</h2><h3 id="2-1-优势☆"><a href="#2-1-优势☆" class="headerlink" title="2.1 优势☆"></a>2.1 优势☆</h3><p><strong>应用解耦</strong> <code>提升容错性和可维护性</code></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155513.png" alt="image-20201214202740735"></p><p>系统的耦合性越高，容错性就越低，可维护性就越低。</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155515.png" alt="image-20201214202817687"></p><p>使用 MQ 使得应用间解耦，提升容错性和可维护性。</p><hr><p><strong>异步提速</strong> <code>提升用户体验和系统吞吐量（单位时间内处理请求的数目）。</code></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155518.png" alt="image-20201214203001503"></p><p>一个下单操作耗时：20 + 300 + 300 + 300 = 920ms，用户点击完下单按钮后，需要等待920ms才能得到下单响应，太慢！</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155520.png" alt="image-20201214203119022"></p><p>用户点击完下单按钮后，只需等待20 + 5 = 25ms就能得到下单响应 。</p><hr><p><strong>削峰填谷</strong> <code>可以提高系统稳定性</code></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155522.png" alt="image-20201214203243219"></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155525.png" alt="image-20201214203331072"></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155527.png" alt="image-20201214203352618"></p><p>使用了 MQ 之后，限制消费消息的速度为1000，这样一来，高峰期产生的数据势必会被积压在 MQ 中，高峰就被<code>“削”</code>掉了，但是因为消息积压，在高峰期过后的一段时间内，消费消息的速度还是会维持在1000，直到消费完积压的消息，这就叫做<code>“填谷”</code>。</p><h3 id="2-2-劣势"><a href="#2-2-劣势" class="headerlink" title="2.2 劣势"></a>2.2 劣势</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155529.png" alt="rabbit劣势"></p><p><strong>系统可用性降低</strong></p><p>系统引入的外部依赖越多，系统稳定性越差。一旦 MQ 宕机，就会对业务造成影响。==如何保证MQ的高可用？==</p><p><strong>系统复杂度提高</strong></p><p>MQ 的加入大大增加了系统的复杂度，以前系统间是同步的远程调用，现在是通过 MQ 进行异步调用。如何保证消息没有被重复消费？怎么处理消息丢失情况？那么保证消息传递的顺序性？</p><p><strong>一致性问题</strong></p><p>A 系统处理完业务，通过 MQ 给B、C、D三个系统发消息数据，如果 B 系统、C 系统处理成功，D 系统处理失败。如何保证消息数据处理的一致性？</p><h3 id="2-3-使用-MQ-需要满足什么条件呢？"><a href="#2-3-使用-MQ-需要满足什么条件呢？" class="headerlink" title="2.3 使用 MQ 需要满足什么条件呢？"></a>2.3 使用 MQ 需要满足什么条件呢？</h3><ol><li>生产者不需要从消费者处获得反馈。</li></ol><blockquote><p>引入消息队列之前的直接调用，其接口的返回值应该为空，这才让明明下层的动作还没做，上层却当成动作做完了继续往后走，即所谓异步成为了可能。</p></blockquote><ol start="2"><li>容许短暂的不一致性。</li><li>解耦、提速、削峰这些方面的收益，超过加入MQ，管理MQ这些成本。</li></ol><h2 id="3-常见的MQ产品"><a href="#3-常见的MQ产品" class="headerlink" title="3. 常见的MQ产品"></a>3. 常见的MQ产品</h2><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155533.png" alt="image-20201214204101628"></p><h1 id="RabbitMQ基本介绍"><a href="#RabbitMQ基本介绍" class="headerlink" title="RabbitMQ基本介绍"></a>RabbitMQ基本介绍</h1><p>2007年，Rabbit 技术公司基于 AMQP 标准开发的 RabbitMQ 1.0 发布。RabbitMQ 采用 Erlang 语言开发。Erlang 语言由 Ericson 设计，专门为开发高并发和分布式系统的一种语言，在电信领域使用广泛。</p><p><strong>AMQP</strong>，即 Advanced Message Queuing Protocol（高级消息队列协议），是一个网络协议，是<code>应用层协议</code>的一个开放标准，为面向消息的中间件设计。基于此协议的客户端与消息中间件可传递消息，并不受客户端/中间件不同产品，不同的开发语言等条件的限制。<code>2006年，AMQP 规范发布。类比HTTP。</code></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155537.png" alt="image-20210202165357596"></p><h2 id="1-RabbitMQ-基础架构"><a href="#1-RabbitMQ-基础架构" class="headerlink" title="1. RabbitMQ 基础架构"></a>1. RabbitMQ 基础架构</h2><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155544.png" alt="image-20201214204938331"></p><h2 id="2-RabbitMQ-中的相关概念"><a href="#2-RabbitMQ-中的相关概念" class="headerlink" title="2. RabbitMQ 中的相关概念"></a>2. RabbitMQ 中的相关概念</h2><p><code>Broker：</code>接收和分发消息的应用，<code>RabbitMQ Server就是 Message Broker。</code></p><p><code>Virtual host：</code>出于多租户和安全因素设计的，把 AMQP 的基本组件划分到一个虚拟的分组中，类似于网络中的 namespace 概念。当多个不同的用户使用同一个 RabbitMQ server 提供的服务时，可以划分出多个vhost，每个用户在自己的 vhost 创建 exchange／queue 等。</p><p><code>Connection：</code>publisher／consumer 和 broker 之间的 TCP 连接。</p><p><code>Channel：</code>如果每一次访问 RabbitMQ 都建立一个 Connection，在消息量大的时候建立 TCP Connection的开销将是巨大的，效率也较低。Channel 是在 connection 内部建立的逻辑连接，如果应用程序支持多线程，通常每个thread创建单独的 channel 进行通讯，AMQP method 包含了channel id 帮助客户端和message broker 识别 channel，所以 channel 之间是完全隔离的。Channel 作为轻量级的 Connection 极大减少了操作系统建立 TCP connection 的开销。</p><p><code>Exchange：</code>message 到达 broker 的第一站，根据分发规则，<code>匹配查询表中的 routing key，</code>分发消息到queue 中去。常用的类型有：</p><ul><li>direct (point-to-point)</li><li>topic (publish-subscribe)</li><li>fanout (multicast)</li></ul><p><code>Queue：</code>消息最终被送到这里等待 consumer 取走</p><p><code>Binding：</code>exchange 和 queue 之间的虚拟连接，binding 中可以包含 routing key。Binding 信息被保存到 exchange 中的查询表中，用于 message 的分发依据</p><h2 id="3-RabbitMQ的6-种工作模式☆"><a href="#3-RabbitMQ的6-种工作模式☆" class="headerlink" title="3. RabbitMQ的6 种工作模式☆"></a>3. RabbitMQ的6 种工作模式☆</h2><p>==简单模式、work queues、Publish/Subscribe 发布与订阅模式、Routing 路由模式、Topics 主题模式、RPC 远程调用模式（远程调用，不太算 MQ；暂不作介绍）。==</p><p>官网对应模式介绍：<a target="_blank" rel="noopener" href="https://www.rabbitmq.com/getstarted.html">https://www.rabbitmq.com/getstarted.html</a></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155604.png" alt="1555988678324"></p><h2 id="4-AMQP-和-JMS"><a href="#4-AMQP-和-JMS" class="headerlink" title="4. AMQP 和 JMS"></a>4. AMQP 和 JMS</h2><p>MQ是消息通信的模型；实现MQ的大致有两种主流方式：AMQP、JMS。</p><h3 id="4-1-AMQP"><a href="#4-1-AMQP" class="headerlink" title="4.1 AMQP"></a>4.1 AMQP</h3><p>AMQP是一种协议，更准确的说是一种binary wire-level protocol（链接协议）。这是其和JMS的本质差别，AMQP不从API层进行限定，而是直接<code>定义网络交换的数据格式</code>。</p><h3 id="4-2-JMS"><a href="#4-2-JMS" class="headerlink" title="4.2 JMS"></a>4.2 JMS</h3><p><code>JMS即Java消息服务（JavaMessage Service）应用程序接口，</code>是一个Java平台中关于面向消息中间件（MOM）的API，用于在两个应用程序之间，或分布式系统中发送消息，进行异步通信。</p><p>JMS 是 JavaEE 规范中的一种，类比JDBC。</p><h3 id="4-3-AMQP-与-JMS-区别☆"><a href="#4-3-AMQP-与-JMS-区别☆" class="headerlink" title="4.3 AMQP 与 JMS 区别☆"></a>4.3 AMQP 与 JMS 区别☆</h3><p>本质：JMS是定义了统一的<strong>接口</strong>，对消息进行统一操作；AMQP<strong>只是协议</strong>，只规定了数据交互的格式</p><p>语言：JMS必须<strong>使用Java</strong>语言；AMQP不规定实现方式，是<strong>跨语言</strong>的。</p><p>消息模式：JMS规定了<strong>两种</strong>，而AMQP的<strong>多种</strong>消息模式</p><h3 id="4-4-再谈市场上常见的消息队列"><a href="#4-4-再谈市场上常见的消息队列" class="headerlink" title="4.4 再谈市场上常见的消息队列"></a>4.4 再谈市场上常见的消息队列</h3><p>ActiveMQ：基于JMS</p><p>ZeroMQ：基于C语言开发</p><p>RabbitMQ：基于AMQP协议，erlang语言开发，稳定性好</p><p>RocketMQ：基于JMS，阿里巴巴产品</p><p>Kafka：类似MQ的产品；分布式消息系统，高吞吐量。</p><hr><h1 id="AMQP"><a href="#AMQP" class="headerlink" title="AMQP"></a>AMQP</h1><h2 id="1-相关概念介绍"><a href="#1-相关概念介绍" class="headerlink" title="1. 相关概念介绍"></a>1. 相关概念介绍</h2><p>AMQP 一个提供统一消息服务的应用层标准高级消息队列协议，是应用层协议的一个开放标准，为面向消息的中间件设计。</p><p>AMQP是一个二进制协议，拥有一些现代化特点：多信道、协商式，异步，安全，扩平台，中立，高效。</p><p>RabbitMQ是AMQP协议的Erlang的实现。</p><table><thead><tr><th>概念</th><th>说明</th></tr></thead><tbody><tr><td>连接Connection</td><td>一个网络连接，比如TCP/IP套接字连接。</td></tr><tr><td>会话Session</td><td>端点之间的命名对话。在一个会话上下文中，保证“恰好传递一次”。</td></tr><tr><td>信道Channel</td><td>多路复用连接中的一条独立的双向数据流通道。为会话提供物理传输介质。</td></tr><tr><td>客户端Client</td><td>AMQP连接或者会话的发起者。AMQP是非对称的，客户端生产和消费消息，服务器存储和路由这些消息。</td></tr><tr><td>服务节点Broker</td><td>消息中间件的服务节点；一般情况下可以将一个RabbitMQ Broker看作一台RabbitMQ 服务器。</td></tr><tr><td>端点</td><td>AMQP对话的任意一方。一个AMQP连接包括两个端点（一个是客户端，一个是服务器）。</td></tr><tr><td>消费者Consumer</td><td>一个从消息队列里请求消息的客户端程序。</td></tr><tr><td>生产者Producer</td><td>一个向交换机发布消息的客户端应用程序。</td></tr></tbody></table><h2 id="2-RabbitMQ运转流程"><a href="#2-RabbitMQ运转流程" class="headerlink" title="2. RabbitMQ运转流程"></a>2. RabbitMQ运转流程</h2><p>在入门案例中：</p><ul><li>生产者发送消息<ol><li>生产者创建连接（Connection），开启一个信道（Channel），连接到RabbitMQ Broker；</li><li>声明队列并设置属性；是否排它，是否持久化，是否自动删除；</li><li>将路由键（空字符串）与队列绑定起来；</li><li>发送消息至RabbitMQ Broker；</li><li>关闭信道；</li><li>关闭连接；</li></ol></li><li>消费者接收消息<ol><li>消费者创建连接（Connection），开启一个信道（Channel），连接到RabbitMQ Broker</li><li>向Broker 请求消费相应队列中的消息，设置相应的回调函数；</li><li>等待Broker回应闭关投递响应队列中的消息，消费者接收消息；</li><li>确认（ack，自动确认）接收到的消息；</li><li>RabbitMQ从队列中删除相应已经被确认的消息；</li><li>关闭信道；</li><li>关闭连接；</li></ol></li></ul><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155610.png" alt="1565105223969"></p><h2 id="3-生产者流转过程说明☆"><a href="#3-生产者流转过程说明☆" class="headerlink" title="3. 生产者流转过程说明☆"></a>3. 生产者流转过程说明☆</h2><ol><li>客户端与代理服务器Broker建立连接。会调用newConnection() 方法，这个方法会进一步封装Protocol Header 0-9-1 的报文头发送给Broker ，以此通知Broker 本次交互采用的是AMQPO-9-1 协议，紧接着Broker 返回Connection.Start 来建立连接，在连接的过程中涉及Connection.Start/.Start-OK 、Connection.Tune/.Tune-Ok ，Connection.Open/ .Open-Ok 这6 个命令的交互。</li><li>客户端调用connection.createChannel方法。此方法开启信道，其包装的channel.open命令发送给Broker,等待channel.basicPublish方法，对应的AMQP命令为Basic.Publish,这个命令包含了content Header 和content Body()。content Header 包含了消息体的属性，例如:投递模式，优先级等，content Body 包含了消息体本身。</li><li>客户端发送完消息需要关闭资源时，涉及到Channel.Close和Channl.Close-Ok 与Connetion.Close和Connection.Close-Ok的命令交互。</li></ol><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155612.png" alt="image-20210203103412258"></p><h2 id="4-消费者流转过程说明☆"><a href="#4-消费者流转过程说明☆" class="headerlink" title="4. 消费者流转过程说明☆"></a>4. 消费者流转过程说明☆</h2><ol><li>消费者客户端与代理服务器Broker建立连接。会调用newConnection() 方法，这个方法会进一步封装Protocol Header 0-9-1 的报文头发送给Broker ，以此通知Broker 本次交互采用的是AMQPO-9-1 协议，紧接着Broker 返回Connection.Start 来建立连接，在连接的过程中涉及Connection.Start/.Start-OK 、Connection.Tune/.Tune-Ok ，Connection.Open/ .Open-Ok 这6 个命令的交互。</li><li>消费者客户端调用connection.createChannel方法。和生产者客户端一样，协议涉及Channel . Open/Open-Ok命令。</li><li>在真正消费之前，消费者客户端需要向Broker 发送Basic.Consume 命令(即调用channel.basicConsume 方法〉将Channel 置为接收模式，之后Broker 回执Basic . Consume - Ok 以告诉消费者客户端准备好消费消息。</li><li>Broker 向消费者客户端推送(Push) 消息，即Basic.Deliver 命令，这个命令和Basic.Publish 命令一样会携带Content Header 和Content Body。</li><li>消费者接收到消息并正确消费之后，向Broker 发送确认，即Basic.Ack 命令。</li><li>客户端发送完消息需要关闭资源时，涉及到Channel.Close和Channl.Close-Ok 与Connetion.Close和Connection.Close-Ok的命令交互。</li></ol><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155618.png" alt="image-20210203103458054"></p><hr><h1 id="RabbitMQ的安装和配置（了解）"><a href="#RabbitMQ的安装和配置（了解）" class="headerlink" title="RabbitMQ的安装和配置（了解）"></a>RabbitMQ的安装和配置（了解）</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Kermit_father/article/details/105181740">https://blog.csdn.net/Kermit_father/article/details/105181740</a></p><h2 id="1-安装依赖环境"><a href="#1-安装依赖环境" class="headerlink" title="1. 安装依赖环境"></a>1. 安装依赖环境</h2><p>在线安装依赖环境：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install build-essential openssl openssl-devel unixODBC unixODBC-devel make gcc gcc-c++ kernel-devel m4 ncurses-devel tk tc xz</span><br></pre></td></tr></table></figure><h2 id="2-安装Erlang"><a href="#2-安装Erlang" class="headerlink" title="2. 安装Erlang"></a>2. 安装Erlang</h2><p>下载下面三个安装包</p><blockquote><p>erlang-18.3-1.el7.centos.x86_64.rpm</p><p>socat-1.7.3.2-5.el7.lux.x86_64.rpm</p><p>rabbitmq-server-3.6.5-1.noarch.rpm</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#下载erlang</span></span><br><span class="line">wget www.rabbitmq.com/releases/erlang/erlang-18.3-1.el7.centos.x86_64.rpm</span><br><span class="line"></span><br><span class="line"><span class="comment">#下载socat</span></span><br><span class="line">wget http://repo.iotti.biz/CentOS/7/x86_64/socat-1.7.3.2-5.el7.lux.x86_64.rpm</span><br><span class="line"></span><br><span class="line"><span class="comment">#下载rabbitmq-server</span></span><br><span class="line">wget www.rabbitmq.com/releases/rabbitmq-server/v3.6.5/rabbitmq-server-3.6.5-1.noarch.rpm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装</span></span><br><span class="line">rpm -ivh erlang-18.3-1.el7.centos.x86_64.rpm</span><br></pre></td></tr></table></figure><p>如果出现如下错误</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155622.png" alt="1565526174751"></p><p>说明gblic 版本太低。我们可以查看当前机器的gblic 版本</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings /lib64/libc.so.6 | grep GLIBC</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155624.png" alt="1565526264426"></p><h3 id="2-1升级glibc-非必须"><a href="#2-1升级glibc-非必须" class="headerlink" title="2.1升级glibc(非必须)"></a>2.1升级glibc(非必须)</h3><p>当前最高版本2.12，需要2.15.所以需要升级glibc</p><ul><li><p>使用yum更新安装依赖</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gcc make -y</span><br></pre></td></tr></table></figure></li><li><p>下载rpm包</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget http://copr-be.cloud.fedoraproject.org/results/mosquito/myrepo-el6/epel-6-x86_64/glibc-2.17-55.fc20/glibc-utils-2.17-55.el6.x86_64.rpm &amp;</span><br><span class="line">wget http://copr-be.cloud.fedoraproject.org/results/mosquito/myrepo-el6/epel-6-x86_64/glibc-2.17-55.fc20/glibc-static-2.17-55.el6.x86_64.rpm &amp;</span><br><span class="line">wget http://copr-be.cloud.fedoraproject.org/results/mosquito/myrepo-el6/epel-6-x86_64/glibc-2.17-55.fc20/glibc-2.17-55.el6.x86_64.rpm &amp;</span><br><span class="line">wget http://copr-be.cloud.fedoraproject.org/results/mosquito/myrepo-el6/epel-6-x86_64/glibc-2.17-55.fc20/glibc-common-2.17-55.el6.x86_64.rpm &amp;</span><br><span class="line">wget http://copr-be.cloud.fedoraproject.org/results/mosquito/myrepo-el6/epel-6-x86_64/glibc-2.17-55.fc20/glibc-devel-2.17-55.el6.x86_64.rpm &amp;</span><br><span class="line">wget http://copr-be.cloud.fedoraproject.org/results/mosquito/myrepo-el6/epel-6-x86_64/glibc-2.17-55.fc20/glibc-headers-2.17-55.el6.x86_64.rpm &amp;</span><br><span class="line">wget http://copr-be.cloud.fedoraproject.org/results/mosquito/myrepo-el6/epel-6-x86_64/glibc-2.17-55.fc20/nscd-2.17-55.el6.x86_64.rpm &amp;</span><br></pre></td></tr></table></figure></li><li><p>安装rpm包</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rpm -Uvh *-2.17-55.el6.x86_64.rpm --force --nodeps</span><br></pre></td></tr></table></figure></li><li><p>安装完毕后再查看glibc版本,发现glibc版本已经到2.17了</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings /lib64/libc.so.6 | grep GLIBC</span><br></pre></td></tr></table></figure></li></ul><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155627.png" alt="1565528746057"></p><h2 id="3-安装RabbitMQ"><a href="#3-安装RabbitMQ" class="headerlink" title="3. 安装RabbitMQ"></a>3. 安装RabbitMQ</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">rpm -ivh socat-1.7.3.2-5.el7.lux.x86_64.rpm</span><br><span class="line"><span class="comment"># 安装</span></span><br><span class="line">rpm -ivh rabbitmq-server-3.6.5-1.noarch.rpm</span><br></pre></td></tr></table></figure><h2 id="4-开启管理界面及配置"><a href="#4-开启管理界面及配置" class="headerlink" title="4. 开启管理界面及配置"></a>4. 开启管理界面及配置</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开启管理界面</span></span><br><span class="line">rabbitmq-plugins <span class="built_in">enable</span> rabbitmq_management</span><br><span class="line"><span class="comment"># 修改默认配置信息 </span></span><br><span class="line">vim rabbitmq/lib/rabbitmq_server-3.6.5/ebin/rabbit.app </span><br><span class="line"><span class="comment"># 比如修改密码、配置等等，例如：loopback_users 中的 &lt;&lt;&quot;guest&quot;&gt;&gt;,只保留guest</span></span><br></pre></td></tr></table></figure><h2 id="5-启动"><a href="#5-启动" class="headerlink" title="5. 启动"></a>5. 启动</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">systemctl start rabbitmq-server  <span class="comment"># 启动服务</span></span><br><span class="line">systemctl stop rabbitmq-server  <span class="comment"># 停止服务</span></span><br><span class="line">systemctl restart rabbitmq-server  <span class="comment"># 重启服务</span></span><br><span class="line">systemctl status rabbitmq-server</span><br></pre></td></tr></table></figure><p>设置配置文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/share/doc/rabbitmq-server-3.6.5/</span><br><span class="line">cp rabbitmq.config.example /etc/rabbitmq/rabbitmq.config</span><br></pre></td></tr></table></figure><p>启动rabbitmq</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/lib/rabbitmq/lib/rabbitmq_server-3.6.5/ebin</span><br><span class="line"> rabbitmq-server start &amp;</span><br></pre></td></tr></table></figure><p>常用命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  rabbitmq-server -deched  --后台启动节点</span><br><span class="line">  rabbitmqctl stop_app --关闭节点上的应用</span><br><span class="line">  rabbitmqctl start_app --启动节点上的应用</span><br><span class="line">  rabbitmqctl stop --关闭节点</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155631.png" alt="image-20201215115721783"></p><blockquote><p>修改了用户名之后，重启服务器造成创建用户丢失：</p><p>因为rabbitmq数据是根据当前hostname作为node节点作为数据名保存，这一点可以从rabbitmq-env文件中可以看出。</p><p>解决方案：</p><ol><li>不要更改hostname</li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_27037443/article/details/78050526">https://blog.csdn.net/qq_27037443/article/details/78050526</a></li></ol></blockquote><h2 id="6-配置虚拟主机及用户"><a href="#6-配置虚拟主机及用户" class="headerlink" title="6. 配置虚拟主机及用户"></a>6. 配置虚拟主机及用户</h2><h3 id="6-1-用户角色"><a href="#6-1-用户角色" class="headerlink" title="6.1 用户角色"></a>6.1 用户角色</h3><p>RabbitMQ在安装好后，可以访问<code>http://ip地址:15672</code> ；其自带了guest/guest的用户名和密码；如果需要创建自定义用户；那么也可以登录管理界面后，如下操作：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155634.png" alt="1565098043833"></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155636.png" alt="1565098315375"></p><p><strong>角色说明</strong>：</p><p>1、 超级管理员(administrator)</p><p>可登陆管理控制台，可查看所有的信息，并且可以对用户，策略(policy)进行操作。</p><p>2、 监控者(monitoring)</p><p>可登陆管理控制台，同时可以查看rabbitmq节点的相关信息(进程数，内存使用情况，磁盘使用情况等)</p><p>3、 策略制定者(policymaker)</p><p>可登陆管理控制台, 同时可以对policy进行管理。但无法查看节点的相关信息(上图红框标识的部分)。</p><p>4、 普通管理者(management)</p><p>仅可登陆管理控制台，无法看到节点信息，也无法对策略进行管理。</p><p>5、 其他</p><p>无法登陆管理控制台，通常就是普通的生产者和消费者。</p><h3 id="6-2-Virtual-Hosts配置"><a href="#6-2-Virtual-Hosts配置" class="headerlink" title="6.2 Virtual Hosts配置"></a>6.2 Virtual Hosts配置</h3><p>像mysql拥有数据库的概念并且可以指定用户对库和表等操作的权限。RabbitMQ也有类似的权限管理；在RabbitMQ中可以虚拟消息服务器Virtual Host，每个Virtual Hosts相当于一个相对独立的RabbitMQ服务器，每个VirtualHost之间是相互隔离的。exchange、queue、message不能互通。 相当于mysql的db。Virtual Name一般以/开头。</p><p><strong>创建Virtual Hosts</strong></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155639.png" alt="1565098496482"></p><p><strong>设置Virtual Hosts权限</strong></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155641.png" alt="1565098585317"></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155643.png" alt="1565098719054"></p><hr><h1 id="RabbitMQ入门"><a href="#RabbitMQ入门" class="headerlink" title="RabbitMQ入门"></a>RabbitMQ入门</h1><h3 id="1-搭建示例工程"><a href="#1-搭建示例工程" class="headerlink" title="1. 搭建示例工程"></a>1. 搭建示例工程</h3><p><a target="_blank" rel="noopener" href="https://gitee.com/lixiaogou/rabbitmq">https://gitee.com/lixiaogou/rabbitmq</a></p><p>消息生产者com.itheima.producer.Producer_HelloWorld;</p><p>在执行上述的消息发送之后；可以登录rabbitMQ的管理控制台，可以发现队列和其消息：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155646.png" alt="image-20201214231440832"></p><hr><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155649.png" alt="image-20201214231617494"></p><p>消息消费者com.itheima.consumer.Consumer_HelloWorld;</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155656.png" alt="image-20201214231933716"></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155657.png" alt="image-20201214232206963"></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155700.png" alt="image-20201214232226947"></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155705.png" alt="image-20201214232238896"></p><h3 id="2-小结"><a href="#2-小结" class="headerlink" title="2. 小结"></a>2. 小结</h3><p>上述的入门案例使用的是如下的<code>简单模式：</code></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155708.png" alt="1555991074575"></p><p>在上图的模型中，有以下概念：</p><ul><li>P：生产者，也就是要发送消息的程序</li><li>C：消费者：消息的接受者，会一直等待消息到来。</li><li>queue：消息队列，图中红色部分。可以缓存消息，生产者向其投递消息，消费者从其取出消息。</li></ul><hr><h1 id="RabbitMQ工作模式"><a href="#RabbitMQ工作模式" class="headerlink" title="RabbitMQ工作模式"></a>RabbitMQ工作模式</h1><p>官网对应模式介绍：<a target="_blank" rel="noopener" href="https://www.rabbitmq.com/getstarted.html">https://www.rabbitmq.com/getstarted.html</a></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155714.png" alt="1555988678324"></p><h2 id="1-Helloworld简单模式"><a href="#1-Helloworld简单模式" class="headerlink" title="1. Helloworld简单模式"></a>1. Helloworld简单模式</h2><p>上面入门案例即是简单模式</p><hr><h2 id="2-Work-queues工作队列模式"><a href="#2-Work-queues工作队列模式" class="headerlink" title="2. Work queues工作队列模式"></a>2. Work queues工作队列模式</h2><h3 id="2-1-模式说明"><a href="#2-1-模式说明" class="headerlink" title="2.1 模式说明"></a>2.1 模式说明</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155729.png" alt="1556009144848"></p><p><code>Work Queues</code>与入门程序的<code>简单模式</code>相比，多了一个或一些消费端，多个消费端==竞争==消费同一个队列中的消息。</p><p><code>应用场景</code>：对于 任务过重或任务较多情况使用工作队列可以提高任务处理的速度。例如发送短信服务</p><h3 id="2-2-代码"><a href="#2-2-代码" class="headerlink" title="2.2 代码"></a>2.2 代码</h3><p><code>Work Queues</code>与入门程序的<code>简单模式</code>的代码是几乎一样的；可以完全复制，并复制多个消费者进行竞争消费测试。</p><p><strong>生产者 Producer_WorkQueues</strong></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155734.png" alt="image-20201214233115280"></p><p><strong>消费者1Consumer_WorkQueues1</strong></p><p><strong>消费者2Consumer_WorkQueues2</strong></p><h3 id="2-3-测试"><a href="#2-3-测试" class="headerlink" title="2.3 测试"></a>2.3 测试</h3><p>启动两个消费者，然后再启动生产者发送消息；到IDEA的两个消费者对应的控制台查看是否竞争性的接收到消息。</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155738.png" alt="image-20201214233458985"></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155741.png" alt="image-20201214233412557"></p><h3 id="2-4-小结"><a href="#2-4-小结" class="headerlink" title="2.4 小结"></a>2.4 小结</h3><p>在一个Work queues队列中如果有多个消费者，那么消费者之间对于同一个消息的关系是<code>竞争</code>的关系。</p><hr><h2 id="3-Publish-Subscribe发布订阅模式☆"><a href="#3-Publish-Subscribe发布订阅模式☆" class="headerlink" title="3. Publish/Subscribe发布订阅模式☆"></a>3. Publish/Subscribe发布订阅模式☆</h2><p>前面2个案例中，只有3个角色：</p><ul><li>P：生产者，也就是要发送消息的程序</li><li>C：消费者：消息的接受者，会一直等待消息到来。</li><li>queue：消息队列，图中红色部分</li></ul><h3 id="3-1-模式说明"><a href="#3-1-模式说明" class="headerlink" title="3.1 模式说明"></a>3.1 模式说明</h3><p>在订阅模型中，多了一个<code>exchange</code>角色，而且过程略有变化：</p><ul><li>P：生产者，不再发送消息到队列中，而是发给X（交换机）</li><li>C：消费者，消息的接受者，会一直等待消息到来。</li><li>Queue：消息队列，接收消息、缓存消息。</li><li>Exchange：交换机，图中的X。一方面，接收生产者发送的消息。另一方面，知道如何处理消息，例如递交给某个特别队列、递交给所有队列、或是将消息丢弃。到底如何操作，取决于Exchange的类型。Exchange有常见以下3种类型：<ul><li>Fanout：广播，将消息交给==所有绑定==到交换机的队列</li><li>Direct：定向，把消息交给==符合指定routing key== 的队列</li><li>Topic：通配符，把消息交给==符合routing pattern（路由模式）== 的队列</li></ul></li></ul><p><code>Exchange（交换机）只负责转发消息，不具备存储消息的能力</code>，因此如果没有任何队列与Exchange绑定，或者没有符合路由规则的队列，那么消息会丢失！</p><p>订阅模式示例图：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155744.png" alt="1556014499573"></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155747.png" alt="1556010329032"></p><blockquote><ol><li>每个消费者监听自己的队列。</li><li>生产者将消息发给broker，由交换机将消息转发到绑定此交换机的每个队列，每个绑定交换机的队列都将接收到消息。</li></ol></blockquote><h3 id="3-2-代码"><a href="#3-2-代码" class="headerlink" title="3.2. 代码"></a>3.2. 代码</h3><p>生产者Producer_PubSub</p><p>消费者1Consumer_PubSub1</p><p>消费者2Consumer_PubSub2</p><h3 id="3-3-测试"><a href="#3-3-测试" class="headerlink" title="3.3 测试"></a>3.3 测试</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155751.png" alt="image-20201214235015805"></p><p>启动所有消费者，然后使用生产者发送消息；在每个消费者对应的控制台可以查看到生产者发送的所有消息；到达<code>广播</code>的效果。</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155755.png" alt="image-20201214234959997"></p><p>在执行完测试代码后，其实到RabbitMQ的管理后台找到<code>Exchanges</code>选项卡，点击 <code>test_fanout</code> 的交换机，可以查看到如下的绑定：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155759.png" alt="image-20210203140856511"></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155803.png" alt="image-20201214234927452"></p><h3 id="3-4-小结"><a href="#3-4-小结" class="headerlink" title="3.4 小结"></a>3.4 小结</h3><p>交换机需要与队列进行绑定，绑定之后；一个消息可以被多个消费者收到。</p><p><code>发布订阅模式与工作队列模式的区别</code>，重点还是在交换机上面</p><p>1、工作队列模式不用定义交换机，而发布/订阅模式需要定义交换机。</p><p>2、发布/订阅模式的生产方是面向交换机发送消息，工作队列模式的生产方是面向队列发送消息(底层使用默认交换机)。</p><p>3、发布/订阅模式需要设置队列和交换机的绑定，工作队列模式不需要设置，实际上工作队列模式会将队列绑定到默认的交换机 。</p><hr><h2 id="4-Routing路由模式"><a href="#4-Routing路由模式" class="headerlink" title="4. Routing路由模式"></a>4. Routing路由模式</h2><h3 id="4-1-模式说明"><a href="#4-1-模式说明" class="headerlink" title="4.1 模式说明"></a>4.1 模式说明</h3><p>路由模式特点：</p><ul><li>队列与交换机的绑定，不能是任意绑定了，而是要指定一个<code>RoutingKey</code>（路由key）</li><li>消息的发送方在向Exchange发送消息时，也必须指定消息的 <code>RoutingKey</code>。</li><li>Exchange不再把消息交给每一个绑定的队列，而是根据消息的<code>Routing Key</code>进行判断，只有队列的<code>Routingkey</code>与消息的 <code>Routing key</code>完全一致，才会接收到消息</li></ul><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155808.png" alt="1556029284397"></p><p>图解：</p><ul><li>P：生产者，向Exchange发送消息，发送消息时，会指定一个routing key。</li><li>X：Exchange（交换机），接收生产者的消息，然后把消息递交给 与routing key完全匹配的队列</li><li>C1：消费者，其所在队列指定了需要routing key 为 error 的消息</li><li>C2：消费者，其所在队列指定了需要routing key 为 info、error、warning 的消息</li></ul><h3 id="4-2-代码"><a href="#4-2-代码" class="headerlink" title="4.2 代码"></a>4.2 代码</h3><p>在编码上与 <code>Publish/Subscribe发布与订阅模式</code> 的区别是交换机的类型为：Direct，还有队列绑定交换机的时候需要指定routing key。</p><p>生产者Producer_Routing</p><p>消费者1Consumer_Routing1</p><p>消费者2Consumer_Routing2</p><h3 id="4-3-测试"><a href="#4-3-测试" class="headerlink" title="4.3 测试"></a>4.3 测试</h3><p>启动所有消费者，然后使用生产者发送消息；消费者可以接收到生产者发送routing key对应队列的消息；达到<code>按需接收</code>的效果。</p><p>在执行完测试代码后，到RabbitMQ的管理后台找到<code>Exchanges</code>选项卡，点击 <code>test_direct</code> 交换机，可以查看到如下的绑定：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155812.png" alt="image-20210203140818561"></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155817.png" alt="image-20201214235922773"></p><h3 id="4-4-小结"><a href="#4-4-小结" class="headerlink" title="4.4 小结"></a>4.4 小结</h3><p>Routing模式要求队列在绑定交换机时要指定routing key，消息会转发到符合routing key的队列。</p><hr><h2 id="5-Topics通配符模式"><a href="#5-Topics通配符模式" class="headerlink" title="5. Topics通配符模式"></a>5. Topics通配符模式</h2><h3 id="5-1-模式说明"><a href="#5-1-模式说明" class="headerlink" title="5.1. 模式说明"></a>5.1. 模式说明</h3><p><code>Topic</code>类型与<code>Direct</code>相比，都可以根据<code>RoutingKey</code>把消息路由到不同的队列。但是<code>Topic</code>类型可以让队列在绑定<code>Routing key</code> 的时候==使用通配符==！</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155821.png" alt="image-20210206102003412"></p><p><code>Routingkey</code> 一般是由一个或多个单词组成，多个单词之间以”.”分割，例如： <code>item.insert</code></p><p>通配符规则：</p><p><code>#</code>：匹配一个或多个词，多个占位符</p><p><code>*</code>：只匹配一个词，一个占位符</p><p>举例：</p><p><code>item.#</code>：能够匹配<code>item.insert.abc</code> 或者 <code>item.insert</code></p><p><code>item.*</code>：只能匹配<code>item.insert</code></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155825.png" alt="image-20210206102026543"></p><p>图解：</p><ul><li>红色Queue：绑定的是<code>usa.#</code> ，凡是以 <code>usa.</code>开头的routing key 都会被匹配到</li><li>黄色Queue：绑定的是<code>#.news</code> ，凡是以 <code>.news</code>结尾的 routing key 都会被匹配</li></ul><h3 id="5-2-代码"><a href="#5-2-代码" class="headerlink" title="5.2. 代码"></a>5.2. 代码</h3><p>生产者Producer_Topics，所有error级别的日志存入数据库，所有order系统的日志存入数据库</p><p>消费者1Consumer_Topic1</p><p>消费者2Consumer_Topic2</p><h3 id="5-3-测试"><a href="#5-3-测试" class="headerlink" title="5.3 测试"></a>5.3 测试</h3><p>启动所有消费者，然后使用生产者发送消息；在消费者对应的控制台可以查看到生产者发送对应routing key对应队列的消息；到达<code>按照需要接收</code>的效果；并且这些routing key可以使用通配符。</p><p>在执行完测试代码后，其实到RabbitMQ的管理后台找到<code>Exchanges</code>选项卡，点击 <code>test_topic</code> 的交换机，可以查看到如下的绑定：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155829.png" alt="image-20210203142455093"></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155832.png" alt="image-20201215000614183"></p><h3 id="5-4-小结"><a href="#5-4-小结" class="headerlink" title="5.4. 小结"></a>5.4. 小结</h3><p>Topic主题模式可以实现 <code>Publish/Subscribe发布与订阅模式</code> + <code>Routing路由模式</code> 的功能；</p><p>Topic在配置routing key 的时候可以使用通配符，更加灵活。</p><hr><h2 id="6-工作模式总结"><a href="#6-工作模式总结" class="headerlink" title="6. 工作模式总结"></a>6. 工作模式总结</h2><p>1、简单模式 HelloWorld</p><blockquote><p>一个生产者、一个消费者，不需要设置交换机（使用默认的交换机）</p></blockquote><p>2、工作队列模式 Work Queue</p><blockquote><p>一个生产者、多个消费者（竞争关系），不需要设置交换机（使用默认的交换机）</p></blockquote><p>3、发布订阅模式 Publish/subscribe</p><blockquote><p>需要设置类型为==fanout==的交换机，并且交换机和队列进行绑定，当生产者发送消息到交换机后，交换机会将消息发送到绑定的队列，</p></blockquote><p>4、路由模式 Routing</p><blockquote><p>需要设置类型为==direct==的交换机，交换机和队列进行绑定，并且指定routing key，当生产者发送消息到交换机后，交换机会根据routing key将消息发送到对应的队列</p></blockquote><p>5、通配符模式 Topic</p><blockquote><p>需要设置类型为==topic==的交换机，交换机和队列进行绑定，并且指定通配符方式的routing key，当生产者发送消息到交换机后，交换机会根据routing key将消息发送到对应的队列</p></blockquote><hr><h1 id="Spring-整合RabbitMQ"><a href="#Spring-整合RabbitMQ" class="headerlink" title="Spring 整合RabbitMQ"></a>Spring 整合RabbitMQ</h1><h2 id="1-搭建工程"><a href="#1-搭建工程" class="headerlink" title="1. 搭建工程"></a>1. 搭建工程</h2><p><a target="_blank" rel="noopener" href="https://gitee.com/lixiaogou/rabbitmq/tree/master/spring-rabbitmq-producers">https://gitee.com/lixiaogou/rabbitmq/tree/master/spring-rabbitmq-producers</a></p><p><a target="_blank" rel="noopener" href="https://gitee.com/lixiaogou/rabbitmq/tree/master/spring-rabbitmq-consumers">https://gitee.com/lixiaogou/rabbitmq/tree/master/spring-rabbitmq-consumers</a></p><h2 id="2-消息监听器"><a href="#2-消息监听器" class="headerlink" title="2. 消息监听器"></a>2. 消息监听器</h2><h4 id="队列监听器SpringQueueListener"><a href="#队列监听器SpringQueueListener" class="headerlink" title="队列监听器SpringQueueListener"></a>队列监听器SpringQueueListener</h4><h4 id="广播监听器1-FanoutListener1"><a href="#广播监听器1-FanoutListener1" class="headerlink" title="广播监听器1 FanoutListener1"></a>广播监听器1 FanoutListener1</h4><h4 id="广播监听器2FanoutListener2"><a href="#广播监听器2FanoutListener2" class="headerlink" title="广播监听器2FanoutListener2"></a>广播监听器2FanoutListener2</h4><h4 id="星号通配符监听器TopicListenerStar"><a href="#星号通配符监听器TopicListenerStar" class="headerlink" title="星号通配符监听器TopicListenerStar"></a>星号通配符监听器TopicListenerStar</h4><h4 id="井号通配符监听器TopicListenerWell"><a href="#井号通配符监听器TopicListenerWell" class="headerlink" title="井号通配符监听器TopicListenerWell"></a>井号通配符监听器TopicListenerWell</h4><h4 id="井号通配符监听器2TopicListenerWell2"><a href="#井号通配符监听器2TopicListenerWell2" class="headerlink" title="井号通配符监听器2TopicListenerWell2"></a>井号通配符监听器2TopicListenerWell2</h4><h2 id="3-测试"><a href="#3-测试" class="headerlink" title="3. 测试"></a>3. 测试</h2><p>ConsumerTest</p><hr><h1 id="Spring-Boot整合RabbitMQ"><a href="#Spring-Boot整合RabbitMQ" class="headerlink" title="Spring Boot整合RabbitMQ"></a>Spring Boot整合RabbitMQ</h1><h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h2><p>在Spring项目中，可以使用Spring-Rabbit去操作RabbitMQ<br><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-amqp">https://github.com/spring-projects/spring-amqp</a></p><p>尤其是在spring boot项目中只需要引入对应的amqp启动器依赖即可，方便的使用RabbitTemplate发送消息，使用注解接收消息。</p><p>一般在开发过程中：</p><p><code>生产者工程：</code></p><ol><li><p>application.yml文件配置$RabbitMQ$相关信息；</p></li><li><p>在生产者工程中编写配置类，用于创建交换机和队列，并进行绑定</p></li><li><p>注入RabbitTemplate对象，通过RabbitTemplate对象发送消息到交换机</p></li></ol><p><code>消费者工程：</code></p><ol><li><p>application.yml文件配置$RabbitMQ$相关信息</p></li><li><p>创建消息处理类，用于接收队列中的消息并进行处理</p></li></ol><h2 id="2-搭建生产者工程"><a href="#2-搭建生产者工程" class="headerlink" title="2. 搭建生产者工程"></a>2. 搭建生产者工程</h2><p><a target="_blank" rel="noopener" href="https://gitee.com/lixiaogou/rabbitmq/tree/master/springboot-rabbitmq-producer">https://gitee.com/lixiaogou/rabbitmq/tree/master/springboot-rabbitmq-producer</a></p><h3 id="2-1-创建工程"><a href="#2-1-创建工程" class="headerlink" title="2.1 创建工程"></a>2.1 创建工程</h3><h3 id="2-2-添加依赖"><a href="#2-2-添加依赖" class="headerlink" title="2.2 添加依赖"></a>2.2 添加依赖</h3><p>修改pom.xml文件内容为如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>producer-springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--1. 父工程依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--2. rabbitmq--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-3-启动类"><a href="#2-3-启动类" class="headerlink" title="2.3 启动类"></a>2.3 启动类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lixiaolong</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(ProducerApplication.class);</span><br><span class="line">        System.out.println(<span class="string">&quot;介就对了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-4-配置RabbitMQ"><a href="#2-4-配置RabbitMQ" class="headerlink" title="2.4 配置RabbitMQ"></a>2.4 配置RabbitMQ</h3><h4 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h4><p>创建application.yml，内容如下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置RabbitMQ的基本信息  ip 端口 username  password..</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">localhost</span> <span class="comment"># ip</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5672</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">lxl</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">lxl</span></span><br><span class="line">    <span class="attr">virtual-host:</span> <span class="string">/lxl</span></span><br></pre></td></tr></table></figure><h4 id="绑定交换机和队列"><a href="#绑定交换机和队列" class="headerlink" title="绑定交换机和队列"></a>绑定交换机和队列</h4><p>创建RabbitMQ队列与交换机绑定的配置类com.itheima.rabbitmq.config.RabbitMQConfig</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.rabbitmq.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabbitMQConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;boot_topic_exchange&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;boot_queue&quot;</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 1.交换机</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Exchange <span class="title function_">bootExchange</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ExchangeBuilder.topicExchange(EXCHANGE_NAME).durable(<span class="literal">true</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 2.Queue 队列</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">bootQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(QUEUE_NAME).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 3. 队列和交互机绑定关系 Binding</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> queue    队列</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> exchange 交换机</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindQueueExchange</span><span class="params">(Queue queue, Exchange exchange)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(<span class="string">&quot;boot.#&quot;</span>).noargs();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-搭建消费者工程"><a href="#3-搭建消费者工程" class="headerlink" title="3. 搭建消费者工程"></a>3. 搭建消费者工程</h2><p><a target="_blank" rel="noopener" href="https://gitee.com/lixiaogou/rabbitmq/tree/master/springboot-rabbitmq-consumer">https://gitee.com/lixiaogou/rabbitmq/tree/master/springboot-rabbitmq-consumer</a></p><h3 id="3-1-创建工程"><a href="#3-1-创建工程" class="headerlink" title="3.1 创建工程"></a>3.1 创建工程</h3><h3 id="3-2-添加依赖"><a href="#3-2-添加依赖" class="headerlink" title="3.2 添加依赖"></a>3.2 添加依赖</h3><p>修改pom.xml文件内容为如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>consumer-springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- RabbitMQ 启动依赖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-3-启动类"><a href="#3-3-启动类" class="headerlink" title="3.3 启动类"></a>3.3 启动类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.rabbit.consumer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(ConsumerApplication.class, args);</span><br><span class="line">        System.out.println(<span class="string">&quot;介就对了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-4-配置RabbitMQ"><a href="#3-4-配置RabbitMQ" class="headerlink" title="3.4 配置RabbitMQ"></a>3.4 配置RabbitMQ</h3><p>创建application.yml，内容如下：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置RabbitMQ的基本信息  ip 端口 username  password..</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">localhost</span> <span class="comment"># ip</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5672</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">lxl</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">lxl</span></span><br><span class="line">    <span class="attr">virtual-host:</span> <span class="string">/lxl</span></span><br></pre></td></tr></table></figure><h3 id="3-5-消息监听处理类"><a href="#3-5-消息监听处理类" class="headerlink" title="3.5 消息监听处理类"></a>3.5 消息监听处理类</h3><p>编写消息监听器com.itheima.rabbitmq.listener.RabbimtMQListener</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.rabbit.consumer.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Message;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabbimtMQListener</span> &#123;</span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;boot_queue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">ListenerQueue</span><span class="params">(Message message)</span> &#123;</span><br><span class="line">        System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-测试"><a href="#4-测试" class="headerlink" title="4. 测试"></a>4. 测试</h2><p>在生产者工程producer-springboot 中创建测试类，发送消息：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.test;</span><br><span class="line"><span class="keyword">import</span> com.itheima.rabbitmq.config.RabbitMQConfig;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerTest</span> &#123;</span><br><span class="line">    <span class="comment">//1.注入RabbitTemplate</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSend</span><span class="params">()</span>&#123;</span><br><span class="line">        rabbitTemplate.convertAndSend(RabbitMQConfig.EXCHANGE_NAME,<span class="string">&quot;boot.haha&quot;</span>,<span class="string">&quot;boot mq hello~~~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155843.png" alt="image-20201215162243570"></p><p>先运行上述测试程序（交换机和队列才能先被声明和绑定），然后启动消费者；</p><p>在消费者工程consumer-springboot中控制台查看是否接收到对应消息。</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155845.png" alt="image-20201215162317180"></p><p>另外，也可以在RabbitMQ的管理控制台中查看到交换机与队列的绑定：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/typora/RabbitMQ/20220325155848.png" alt="image-20201215162341130"></p><hr><h1 id="☆"><a href="#☆" class="headerlink" title="☆"></a>☆</h1></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">__°ゝ 浮华 つ __</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://lixiaogou.gitee.io/posts/0b29424708cf/">http://lixiaogou.gitee.io/posts/0b29424708cf/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://lixiaogou.gitee.io" target="_blank">__°ゝ 浮华 つ __</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/HTML/">HTML</a><a class="post-meta__tags" href="/tags/Java/">Java</a><a class="post-meta__tags" href="/tags/Spring/">Spring</a><a class="post-meta__tags" href="/tags/SpringBoot/">SpringBoot</a></div><div class="post_share"><div class="social-share" data-image="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E5%AE%9D%E9%9D%92%E5%9D%8A%E4%B8%BB%E8%85%BF.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/416884f2a501/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/bg17.jpg" onerror='onerror=null,src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E5%85%AC%E4%BC%97%E5%8F%B78x8.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">RabbitMQ笔记(高级篇)</div></div></a></div><div class="next-post pull-right"><a href="/posts/bfa052c8a227/"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/bg17.jpg" onerror='onerror=null,src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E5%85%AC%E4%BC%97%E5%8F%B78x8.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">mybatis SQL映射文件详解</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/8cd09dfa66ca/" title="SpringBoot版本2.4 集成freemarker 添加自定义拦截器以后静态资源(css)无法访问的解决办法"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://pic.imgdb.cn/item/6108ac4d5132923bf8ca61c3.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-22</div><div class="title">SpringBoot版本2.4 集成freemarker 添加自定义拦截器以后静态资源(css)无法访问的解决办法</div></div></a></div><div><a href="/posts/f2a72f0b2d3b/" title="springboot实现全局入参解密与出参加密功能"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/bg14.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-24</div><div class="title">springboot实现全局入参解密与出参加密功能</div></div></a></div><div><a href="/posts/06ab33c3e1d1/" title="【Docker】9. Springboot 项目打包Docker镜像"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://pic.imgdb.cn/item/6126fbbd44eaada739d33cad.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-22</div><div class="title">【Docker】9. Springboot 项目打包Docker镜像</div></div></a></div><div><a href="/posts/e17f07a87c3e/" title="springboot注解方式实现接口防刷功能"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://pic.imgdb.cn/item/6108ac4d5132923bf8ca61c3.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-28</div><div class="title">springboot注解方式实现接口防刷功能</div></div></a></div><div><a href="/posts/b6d0d7be726c/" title="springboot全局异常处理"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E8%8A%B1%E6%9C%A8%E5%85%B0-%E4%B9%9D%E9%9C%84%E7%A5%9E%E8%BE%89.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-22</div><div class="title">springboot全局异常处理</div></div></a></div><div><a href="/posts/db4756b90846/" title="Cannot expose request attribute 'errormess' because of an existing model object of the same name"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://pic.imgdb.cn/item/6108ac4d5132923bf8ca61c3.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-22</div><div class="title">Cannot expose request attribute 'errormess' because of an existing model object of the same name</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/moyuyu.gif" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">__°ゝ 浮华 つ __</div><div class="author-info__description">乘风破浪会有时，直挂云帆济沧海</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">89</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">26</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://gitee.com/lixiaogou"><i class="iconfont icon-gitee"></i><span>码云</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/lixiaolong6881644" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://gitee.com/lixiaogou" target="_blank" title="iconfont icon-gitee"><i class="iconfont icon-gitee"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RabbitMQ%E7%AC%94%E8%AE%B0-%E5%9F%BA%E7%A1%80%E7%AF%87"><span class="toc-number">1.</span> <span class="toc-text">RabbitMQ笔记(基础篇)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MQ%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">2.</span> <span class="toc-text">MQ基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-MQ%E6%A6%82%E8%BF%B0"><span class="toc-number">2.1.</span> <span class="toc-text">1. MQ概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-MQ%E7%9A%84%E4%BC%98%E5%8A%BF%E5%92%8C%E5%8A%A3%E5%8A%BF"><span class="toc-number">2.2.</span> <span class="toc-text">2. MQ的优势和劣势</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E4%BC%98%E5%8A%BF%E2%98%86"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.1 优势☆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%8A%A3%E5%8A%BF"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2 劣势</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E4%BD%BF%E7%94%A8-MQ-%E9%9C%80%E8%A6%81%E6%BB%A1%E8%B6%B3%E4%BB%80%E4%B9%88%E6%9D%A1%E4%BB%B6%E5%91%A2%EF%BC%9F"><span class="toc-number">2.2.3.</span> <span class="toc-text">2.3 使用 MQ 需要满足什么条件呢？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%B8%B8%E8%A7%81%E7%9A%84MQ%E4%BA%A7%E5%93%81"><span class="toc-number">2.3.</span> <span class="toc-text">3. 常见的MQ产品</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RabbitMQ%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.</span> <span class="toc-text">RabbitMQ基本介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-RabbitMQ-%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84"><span class="toc-number">3.1.</span> <span class="toc-text">1. RabbitMQ 基础架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-RabbitMQ-%E4%B8%AD%E7%9A%84%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5"><span class="toc-number">3.2.</span> <span class="toc-text">2. RabbitMQ 中的相关概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-RabbitMQ%E7%9A%846-%E7%A7%8D%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F%E2%98%86"><span class="toc-number">3.3.</span> <span class="toc-text">3. RabbitMQ的6 种工作模式☆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-AMQP-%E5%92%8C-JMS"><span class="toc-number">3.4.</span> <span class="toc-text">4. AMQP 和 JMS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-AMQP"><span class="toc-number">3.4.1.</span> <span class="toc-text">4.1 AMQP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-JMS"><span class="toc-number">3.4.2.</span> <span class="toc-text">4.2 JMS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-AMQP-%E4%B8%8E-JMS-%E5%8C%BA%E5%88%AB%E2%98%86"><span class="toc-number">3.4.3.</span> <span class="toc-text">4.3 AMQP 与 JMS 区别☆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E5%86%8D%E8%B0%88%E5%B8%82%E5%9C%BA%E4%B8%8A%E5%B8%B8%E8%A7%81%E7%9A%84%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97"><span class="toc-number">3.4.4.</span> <span class="toc-text">4.4 再谈市场上常见的消息队列</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AMQP"><span class="toc-number">4.</span> <span class="toc-text">AMQP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5%E4%BB%8B%E7%BB%8D"><span class="toc-number">4.1.</span> <span class="toc-text">1. 相关概念介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-RabbitMQ%E8%BF%90%E8%BD%AC%E6%B5%81%E7%A8%8B"><span class="toc-number">4.2.</span> <span class="toc-text">2. RabbitMQ运转流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E7%94%9F%E4%BA%A7%E8%80%85%E6%B5%81%E8%BD%AC%E8%BF%87%E7%A8%8B%E8%AF%B4%E6%98%8E%E2%98%86"><span class="toc-number">4.3.</span> <span class="toc-text">3. 生产者流转过程说明☆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%B6%88%E8%B4%B9%E8%80%85%E6%B5%81%E8%BD%AC%E8%BF%87%E7%A8%8B%E8%AF%B4%E6%98%8E%E2%98%86"><span class="toc-number">4.4.</span> <span class="toc-text">4. 消费者流转过程说明☆</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RabbitMQ%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">RabbitMQ的安装和配置（了解）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96%E7%8E%AF%E5%A2%83"><span class="toc-number">5.1.</span> <span class="toc-text">1. 安装依赖环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%AE%89%E8%A3%85Erlang"><span class="toc-number">5.2.</span> <span class="toc-text">2. 安装Erlang</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1%E5%8D%87%E7%BA%A7glibc-%E9%9D%9E%E5%BF%85%E9%A1%BB"><span class="toc-number">5.2.1.</span> <span class="toc-text">2.1升级glibc(非必须)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%AE%89%E8%A3%85RabbitMQ"><span class="toc-number">5.3.</span> <span class="toc-text">3. 安装RabbitMQ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%BC%80%E5%90%AF%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2%E5%8F%8A%E9%85%8D%E7%BD%AE"><span class="toc-number">5.4.</span> <span class="toc-text">4. 开启管理界面及配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%90%AF%E5%8A%A8"><span class="toc-number">5.5.</span> <span class="toc-text">5. 启动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E5%8F%8A%E7%94%A8%E6%88%B7"><span class="toc-number">5.6.</span> <span class="toc-text">6. 配置虚拟主机及用户</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E7%94%A8%E6%88%B7%E8%A7%92%E8%89%B2"><span class="toc-number">5.6.1.</span> <span class="toc-text">6.1 用户角色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-Virtual-Hosts%E9%85%8D%E7%BD%AE"><span class="toc-number">5.6.2.</span> <span class="toc-text">6.2 Virtual Hosts配置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RabbitMQ%E5%85%A5%E9%97%A8"><span class="toc-number">6.</span> <span class="toc-text">RabbitMQ入门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%90%AD%E5%BB%BA%E7%A4%BA%E4%BE%8B%E5%B7%A5%E7%A8%8B"><span class="toc-number">6.0.1.</span> <span class="toc-text">1. 搭建示例工程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%B0%8F%E7%BB%93"><span class="toc-number">6.0.2.</span> <span class="toc-text">2. 小结</span></a></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#RabbitMQ%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F"><span class="toc-number">7.</span> <span class="toc-text">RabbitMQ工作模式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Helloworld%E7%AE%80%E5%8D%95%E6%A8%A1%E5%BC%8F"><span class="toc-number">7.1.</span> <span class="toc-text">1. Helloworld简单模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Work-queues%E5%B7%A5%E4%BD%9C%E9%98%9F%E5%88%97%E6%A8%A1%E5%BC%8F"><span class="toc-number">7.2.</span> <span class="toc-text">2. Work queues工作队列模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%A8%A1%E5%BC%8F%E8%AF%B4%E6%98%8E"><span class="toc-number">7.2.1.</span> <span class="toc-text">2.1 模式说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E4%BB%A3%E7%A0%81"><span class="toc-number">7.2.2.</span> <span class="toc-text">2.2 代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%B5%8B%E8%AF%95"><span class="toc-number">7.2.3.</span> <span class="toc-text">2.3 测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E5%B0%8F%E7%BB%93"><span class="toc-number">7.2.4.</span> <span class="toc-text">2.4 小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Publish-Subscribe%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F%E2%98%86"><span class="toc-number">7.3.</span> <span class="toc-text">3. Publish&#x2F;Subscribe发布订阅模式☆</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%A8%A1%E5%BC%8F%E8%AF%B4%E6%98%8E"><span class="toc-number">7.3.1.</span> <span class="toc-text">3.1 模式说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E4%BB%A3%E7%A0%81"><span class="toc-number">7.3.2.</span> <span class="toc-text">3.2. 代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E6%B5%8B%E8%AF%95"><span class="toc-number">7.3.3.</span> <span class="toc-text">3.3 测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E5%B0%8F%E7%BB%93"><span class="toc-number">7.3.4.</span> <span class="toc-text">3.4 小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Routing%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%BC%8F"><span class="toc-number">7.4.</span> <span class="toc-text">4. Routing路由模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E6%A8%A1%E5%BC%8F%E8%AF%B4%E6%98%8E"><span class="toc-number">7.4.1.</span> <span class="toc-text">4.1 模式说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E4%BB%A3%E7%A0%81"><span class="toc-number">7.4.2.</span> <span class="toc-text">4.2 代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E6%B5%8B%E8%AF%95"><span class="toc-number">7.4.3.</span> <span class="toc-text">4.3 测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E5%B0%8F%E7%BB%93"><span class="toc-number">7.4.4.</span> <span class="toc-text">4.4 小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Topics%E9%80%9A%E9%85%8D%E7%AC%A6%E6%A8%A1%E5%BC%8F"><span class="toc-number">7.5.</span> <span class="toc-text">5. Topics通配符模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E6%A8%A1%E5%BC%8F%E8%AF%B4%E6%98%8E"><span class="toc-number">7.5.1.</span> <span class="toc-text">5.1. 模式说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E4%BB%A3%E7%A0%81"><span class="toc-number">7.5.2.</span> <span class="toc-text">5.2. 代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E6%B5%8B%E8%AF%95"><span class="toc-number">7.5.3.</span> <span class="toc-text">5.3 测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E5%B0%8F%E7%BB%93"><span class="toc-number">7.5.4.</span> <span class="toc-text">5.4. 小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F%E6%80%BB%E7%BB%93"><span class="toc-number">7.6.</span> <span class="toc-text">6. 工作模式总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring-%E6%95%B4%E5%90%88RabbitMQ"><span class="toc-number">8.</span> <span class="toc-text">Spring 整合RabbitMQ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%90%AD%E5%BB%BA%E5%B7%A5%E7%A8%8B"><span class="toc-number">8.1.</span> <span class="toc-text">1. 搭建工程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%B6%88%E6%81%AF%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-number">8.2.</span> <span class="toc-text">2. 消息监听器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%98%9F%E5%88%97%E7%9B%91%E5%90%AC%E5%99%A8SpringQueueListener"><span class="toc-number">8.2.0.1.</span> <span class="toc-text">队列监听器SpringQueueListener</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B9%BF%E6%92%AD%E7%9B%91%E5%90%AC%E5%99%A81-FanoutListener1"><span class="toc-number">8.2.0.2.</span> <span class="toc-text">广播监听器1 FanoutListener1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B9%BF%E6%92%AD%E7%9B%91%E5%90%AC%E5%99%A82FanoutListener2"><span class="toc-number">8.2.0.3.</span> <span class="toc-text">广播监听器2FanoutListener2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%9F%E5%8F%B7%E9%80%9A%E9%85%8D%E7%AC%A6%E7%9B%91%E5%90%AC%E5%99%A8TopicListenerStar"><span class="toc-number">8.2.0.4.</span> <span class="toc-text">星号通配符监听器TopicListenerStar</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%95%E5%8F%B7%E9%80%9A%E9%85%8D%E7%AC%A6%E7%9B%91%E5%90%AC%E5%99%A8TopicListenerWell"><span class="toc-number">8.2.0.5.</span> <span class="toc-text">井号通配符监听器TopicListenerWell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%95%E5%8F%B7%E9%80%9A%E9%85%8D%E7%AC%A6%E7%9B%91%E5%90%AC%E5%99%A82TopicListenerWell2"><span class="toc-number">8.2.0.6.</span> <span class="toc-text">井号通配符监听器2TopicListenerWell2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%B5%8B%E8%AF%95"><span class="toc-number">8.3.</span> <span class="toc-text">3. 测试</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring-Boot%E6%95%B4%E5%90%88RabbitMQ"><span class="toc-number">9.</span> <span class="toc-text">Spring Boot整合RabbitMQ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%AE%80%E4%BB%8B"><span class="toc-number">9.1.</span> <span class="toc-text">1. 简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%90%AD%E5%BB%BA%E7%94%9F%E4%BA%A7%E8%80%85%E5%B7%A5%E7%A8%8B"><span class="toc-number">9.2.</span> <span class="toc-text">2. 搭建生产者工程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%88%9B%E5%BB%BA%E5%B7%A5%E7%A8%8B"><span class="toc-number">9.2.1.</span> <span class="toc-text">2.1 创建工程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96"><span class="toc-number">9.2.2.</span> <span class="toc-text">2.2 添加依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%90%AF%E5%8A%A8%E7%B1%BB"><span class="toc-number">9.2.3.</span> <span class="toc-text">2.3 启动类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E9%85%8D%E7%BD%AERabbitMQ"><span class="toc-number">9.2.4.</span> <span class="toc-text">2.4 配置RabbitMQ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">9.2.4.1.</span> <span class="toc-text">配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%91%E5%AE%9A%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%92%8C%E9%98%9F%E5%88%97"><span class="toc-number">9.2.4.2.</span> <span class="toc-text">绑定交换机和队列</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%90%AD%E5%BB%BA%E6%B6%88%E8%B4%B9%E8%80%85%E5%B7%A5%E7%A8%8B"><span class="toc-number">9.3.</span> <span class="toc-text">3. 搭建消费者工程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%88%9B%E5%BB%BA%E5%B7%A5%E7%A8%8B"><span class="toc-number">9.3.1.</span> <span class="toc-text">3.1 创建工程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96"><span class="toc-number">9.3.2.</span> <span class="toc-text">3.2 添加依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%90%AF%E5%8A%A8%E7%B1%BB"><span class="toc-number">9.3.3.</span> <span class="toc-text">3.3 启动类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E9%85%8D%E7%BD%AERabbitMQ"><span class="toc-number">9.3.4.</span> <span class="toc-text">3.4 配置RabbitMQ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E6%B6%88%E6%81%AF%E7%9B%91%E5%90%AC%E5%A4%84%E7%90%86%E7%B1%BB"><span class="toc-number">9.3.5.</span> <span class="toc-text">3.5 消息监听处理类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%B5%8B%E8%AF%95"><span class="toc-number">9.4.</span> <span class="toc-text">4. 测试</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%98%86"><span class="toc-number">10.</span> <span class="toc-text">☆</span></a></li></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/1a8947346e68/" title="剑指 Offer 47. 礼物的最大价值"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://pic.imgdb.cn/item/6108ac4d5132923bf8ca61c3.png" onerror='this.onerror=null,this.src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E5%85%AC%E4%BC%97%E5%8F%B78x8.jpg"' alt="剑指 Offer 47. 礼物的最大价值"></a><div class="content"><a class="title" href="/posts/1a8947346e68/" title="剑指 Offer 47. 礼物的最大价值">剑指 Offer 47. 礼物的最大价值</a><time datetime="2022-12-21T05:11:23.000Z" title="发表于 2022-12-21 13:11:23">2022-12-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a2481acbdf0a/" title="剑指 Offer 42. 连续子数组的最大和"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/o_201126142701street_race.jpg" onerror='this.onerror=null,this.src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E5%85%AC%E4%BC%97%E5%8F%B78x8.jpg"' alt="剑指 Offer 42. 连续子数组的最大和"></a><div class="content"><a class="title" href="/posts/a2481acbdf0a/" title="剑指 Offer 42. 连续子数组的最大和">剑指 Offer 42. 连续子数组的最大和</a><time datetime="2022-12-21T03:11:23.000Z" title="发表于 2022-12-21 11:11:23">2022-12-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/c2a73c5ce56d/" title="剑指 Offer 63. 股票的最大利润"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E5%85%AC%E4%BC%97%E5%8F%B78x8.jpg" onerror='this.onerror=null,this.src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E5%85%AC%E4%BC%97%E5%8F%B78x8.jpg"' alt="剑指 Offer 63. 股票的最大利润"></a><div class="content"><a class="title" href="/posts/c2a73c5ce56d/" title="剑指 Offer 63. 股票的最大利润">剑指 Offer 63. 股票的最大利润</a><time datetime="2022-12-20T07:11:23.000Z" title="发表于 2022-12-20 15:11:23">2022-12-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/5400ea250071/" title="剑指 Offer 10- II. 青蛙跳台阶问题"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E5%85%AC%E4%BC%97%E5%8F%B78x8.jpg" onerror='this.onerror=null,this.src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E5%85%AC%E4%BC%97%E5%8F%B78x8.jpg"' alt="剑指 Offer 10- II. 青蛙跳台阶问题"></a><div class="content"><a class="title" href="/posts/5400ea250071/" title="剑指 Offer 10- II. 青蛙跳台阶问题">剑指 Offer 10- II. 青蛙跳台阶问题</a><time datetime="2022-12-20T06:11:23.000Z" title="发表于 2022-12-20 14:11:23">2022-12-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/e0fc265ccf17/" title="剑指 Offer 10- I. 斐波那契数列"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E8%8A%88%E6%9C%88-%E7%99%BD%E6%99%B6%E6%99%B6.jpg" onerror='this.onerror=null,this.src="https://lxiaol.oss-cn-beijing.aliyuncs.com/pictures/%E5%85%AC%E4%BC%97%E5%8F%B78x8.jpg"' alt="剑指 Offer 10- I. 斐波那契数列"></a><div class="content"><a class="title" href="/posts/e0fc265ccf17/" title="剑指 Offer 10- I. 斐波那契数列">剑指 Offer 10- I. 斐波那契数列</a><time datetime="2022-12-20T03:11:23.000Z" title="发表于 2022-12-20 11:11:23">2022-12-20</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 <i id="heartbeat" class="fa fas fa-heartbeat"></i> __°ゝ 浮华 つ __</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">乘风破浪会有时，直挂云帆济沧海</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script data-pjax src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script data-pjax src="/js/xkTool.js"></script><script data-pjax src="/js/myDiyJs.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="卧槽,🐂🍺,666" data-fontsize="15px" data-random="false" async></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>